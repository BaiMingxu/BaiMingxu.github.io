<!DOCTYPE HTML><html lang="zh-Hans"><head><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="keywords" content="比特币地址的生成算法, 区块链 Python Java golang Android H5 michel"><meta name="description" content="
  Go加密算法_⽐比特币地址的生成算法

⼀、⽐特币地址的⽣成步骤(⼀)、概述1、⽐特币是建⽴在数学加密学基础上的，中本聪⽤了椭圆曲线数字签名算法（ECDSA）来产⽣⽐特币的私钥和公钥。
ECDSA算法（Elliptic Curve D"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>比特币地址的生成算法 | michel的梦想</title><link rel="icon" type="image/png" href="/img/favicon.ico"><link href="https://cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-2.2.0.min.js"></script><link rel="stylesheet" href="/css/prism-base16-ateliersulphurpool.light.css" type="text/css"></head></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo"> <a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img hide-on-small-only"> <span class="logo-span">michel的梦想</span></a></div><a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>主页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>更多</span></a></li><li class="hide-on-med-and-down"><a href="/one" class="waves-effect waves-light"><i class="fa fa-gratipay"></i> <span>一句</span></a></li><li class="hide-on-med-and-down"><a href="/gallery" class="waves-effect waves-light"><i class="fa fa-picture-o"></i> <span>图片</span></a></li><li class="hide-on-med-and-down"><a href="/video" class="waves-effect waves-light"><i class="fa fa-video-camera"></i> <span>视频</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>我</span></a></li><li><a id="toggleSearch" class="waves-effect waves-light"><i id="searchIcon" class="mdi-action-search"></i></a></li></ul><div class="side-nav" id="mobile-nav"><div class="mobile-head bg-color"> <img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">michel的梦想</div><div class="logo-desc"> 快乐的人没有过去，不快乐的人除了过去一无所有。</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 主页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 更多</a></li><li><a href="/one" class="waves-effect waves-light"><i class="fa fa-fw fa-gratipay"></i> 一句</a></li><li><a href="/gallery" class="waves-effect waves-light"><i class="fa fa-fw fa-picture-o"></i> 图片</a></li><li><a href="/video" class="waves-effect waves-light"><i class="fa fa-fw fa-video-camera"></i> 视频</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 我</a></li><li><div class="divider"></div></li><li><a href="https://github.com/BaiMingxu" class="waves-effect waves-light" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa fa-github-square fa-fw"></i> Fork Me</a></li></ul></div></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style> <a href="https://github.com/BaiMingxu" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50" rel="external nofollow noopener noreferrer"><svg viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a></nav></header><div class="bg-cover post-cover" style="background-image:url(https://ws1.sinaimg.cn/large/e64a4785gy1fxq19nnjc5j20ku0dw3yt.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-title"> 比特币地址的生成算法</div></div></div></div></div></div><main class="container content"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="article-tag"> <a href="/tags/加密算法/" target="_blank"><span class="chip bg-color">加密算法</span></a> <a href="/tags/比特币/" target="_blank"><span class="chip bg-color">比特币</span></a></div><div class="post-info"><span class="post-date"><i class="fa fa-file-word-o fa-fw"></i> 1.8k<span class="post-date"><i class="fa fa-hourglass-half fa-fw"></i> 6分</span><span class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/区块链/" class="post-category" target="_blank">区块链</a> <a href="/categories/区块链/密码学/" class="post-category" target="_blank">密码学</a></span><span class="post-date"><i class="fa fa-clock-o fa-fw"></i> 2018-11-30</span></span></div></div><hr><div class="card-content article-card-content"><div id="articleContent"><blockquote><p> Go加密算法_⽐比特币地址的生成算法</p></blockquote><h4 id="⼀、⽐特币地址的⽣成步骤"><a href="#⼀、⽐特币地址的⽣成步骤" class="headerlink" title="⼀、⽐特币地址的⽣成步骤"></a>⼀、⽐特币地址的⽣成步骤</h4><h5 id="⼀-、概述"><a href="#⼀-、概述" class="headerlink" title="(⼀)、概述"></a>(⼀)、概述</h5><p>1、⽐特币是建⽴在数学加密学基础上的，中本聪⽤了椭圆曲线数字签名算法（ECDSA）来产⽣⽐特币的私钥和公钥。</p><p>ECDSA算法（Elliptic Curve Digital Signature Algorithm ， 椭圆曲线数字 签名算法），是使⽤椭圆曲线加密学（ECC ，Elliptic Curve Cryptography ）对数字签名算法（DSA ， Digital Signature Algorithm）的模拟。 ECDSA 在1998年就被ISO所接受，于1999年成为ANSI标准，并于2000年成为IEEE 和NIST标准。</p><p>具体来说，⽐特币系统中的椭圆曲线是Certicom推荐的SECP256K1算法。</p><p>Certicom是国际上著名的椭圆曲线密码技术公司。⽽SECP256K1算法由于其构造的特殊性，优化后性能⽐其它曲线算法提⾼30%。</p><p>2、由私钥可以计算出公钥，公钥经过⼀系列数字签名运算会得到⽐特币地址。</p><p>3、因为由公钥可以算出⽐特币地址，所以有⼈经常把公钥和⽐特币地址相混 淆。不过可以把⽐特币地址理解成是另⼀种格式的公钥，所以有时候将⽐特币地 址⼜叫做公钥哈希。</p><p>4、从⽐特币私钥得到⽐特币地址需要10个步骤。中间依次会⽤到SECP256K1、SHA256、RIPEMD160以及BASE58编码。我们平时使⽤的⽐特币地址都是经过BASE58编码之后的结果。⼀般以“1”、“3”开头的34位字符串。（在⽐特币testnet⽹络中⽐特币地址以2开头）<img src="https://wx3.sinaimg.cn/large/e64a4785gy1fxq21c8k3rj20fu09fac0.jpg" alt=""></p><h5 id="（⼆）、Base58Check"><a href="#（⼆）、Base58Check" class="headerlink" title="（⼆）、Base58Check"></a>（⼆）、Base58Check</h5><p>1、Base58Check是⼀种常⽤在⽐特币中的Base58编码格式，增加了错误校验码 来检查数据在转录中出现的错误。</p><p> 2、在⽣成⽐特币地址以及⽣成WIF-compressed格式私钥的过程中都⽤到了 Base58Check。</p><p> 3、在Base58Check中，对数据添加了⼀个称作“版本字节”的前缀，这个前缀⽤ 来明确需要编码的数据的类型。 4、Base58Check的作⽤</p><p>​ 既然有了Base58编码，已经不会搞错0和O, 1和l和I，也把⼤整数转换成了 可读字符串，为什么还要再有Base58Check这个环节呢？</p><p>​ 假设⼀种情况，你在程序中输⼊⼀个Base58编码的地址，尽管你已经不 会搞错0和O, 1和l和I，但是万⼀你不⼩⼼输错⼀个字符，或者少写多写⼀个 字符，会咋样？你可能会说，没啥⼤不了的，错个字符⽽已，这不是很常⻅见 嘛，重新输⼊不就可以了吗？但是当⽤户给⼀个⽐特币地址转账，如果输⼊ 错误，那么对⽅就不会收到资⾦，更关键的是该笔资⾦发给了⼀个根本不存 在的⽐特币地址，那么这笔资⾦也就永远不可能被交易，也就是说⽐特币丢 失了。</p><p>​ 使⽤Base58check编码格式时，程序会计算原始数据的校验码并和⾃带的校验码进⾏对⽐，⼆者若不匹配则表明有错误产⽣。</p><p>​ 实际上，在⽐特币交易中，都会校验⽐特币地址是否合法，如果经过 Base58Check的⽐特币地址被⽐特币钱包程序判定是⽆效的，当然会阻⽌ 交易继续进⾏，就避免了资⾦损失。</p><h5 id="（三）、⽐特币地址⽣成步骤"><a href="#（三）、⽐特币地址⽣成步骤" class="headerlink" title="（三）、⽐特币地址⽣成步骤"></a>（三）、⽐特币地址⽣成步骤</h5><p>1、第⼀步，随机选取⼀个32字节的数、⼤⼩介于1 ~ 0xFFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFE BAAE DCE6 AF48 A03B BFD2 5E8C D036 4141之间，作为私钥。私钥为64位16进制数字。</p><p>A376D3867EA8F2DDB6D80B0A7BD1C57FE51B659D7B0EE264949D02983624344C</p><p>2、第⼆步，使⽤椭圆曲线加密算法（ECDSA-secp256k1）计算私钥所对应的⾮压缩公钥。</p><p>⾮压缩公钥共65字节， 第1个字节是 0x04, 32字节为x坐标，32字节为y 坐标，⼀共是130位16进制数字。</p><p>压缩公钥共33字节，第1个字节是0x02或0x03, 再加x坐标的32字节，⼀ 共是66位16进制数字。</p><p>04</p><p>1BF6C2F0F5DD3F86907F2A942B97C38AB797EB7E73BA80C88371B77EA5C2E040 8AE994868BD2141FEE0695905090BD5FE8B939FEEF6A0BAE0D11D2412DB78B2B</p><p>3、第三步，计算公钥的 SHA-256 哈希值</p><p>F24B7CF9A2378C2F9C1BEB5B4B4C8A3CA16E9F6C076680CAD4BBCBD783B30D89</p><p>4、第四步，取上⼀步结果，计算 RIPEMD-160 哈希值</p><p>9353BD455CDBCAEC7BDBA6AE7224CBF3D9B6D50C</p><p>5、第五步，取上⼀步结果，前⾯加⼊⽹络ID号</p><p>⽐特币主⽹id号：0x00</p><p>testnet测试⽹络id号：0x6f 009353BD455CDBCAEC7BDBA6AE7224CBF3D9B6D50C</p><p>6、第六步，取上⼀步结果，计算 SHA-256 哈希值</p><p>907202A7758189FFA8BD65C2FE0C4DEA768BBE6766E7758B893DD3E97A AAE613</p><p>7、第七步，取上⼀步结果，再计算⼀下 SHA-256 哈希值</p><p>D0295602554B9234DDCBB016F9D6D4E480155482434DEBD297972987A 9E7BA22</p><p>8、第⼋步，取上⼀步结果的前4个字节（8位⼗六进制）作为校验码</p><p>D0295602</p><p>9、第九步，将校验码加在第五步的结果后⾯，这就形成了⽐特币地址的16进制格式。(50位16进制数字)</p><p>009353BD455CDBCAEC7BDBA6AE7224CBF3D9B6D50CD0295602</p><p>10、第⼗步，⽤Base58编码（这是最常使⽤的⽐特币地址格式，34字节⻓度）。</p><p>1ERzeWbxZsZYu7JzR4H2JYx4gNK6Y7Aibb</p><p>我们经常说的⽐特币公钥就是指的图中第⼆步所产⽣的结果。⽽HASH160指的是第四步RIPEMD160签名所产⽣的结果，由于RIPEMD也是⼀种HASH算法所以就统称为HASH160。</p><p><code>⽣成⽐特币地址的步骤详⻅见⽹站</code></p><p>[<a href="http://gobittest.appspot.com/Address]" rel="external nofollow noopener noreferrer" target="_blank">http://gobittest.appspot.com/Address]</a>:</p><p><img src="https://wx3.sinaimg.cn/large/e64a4785gy1fxq2bodbsmj20ow0bzn0w.jpg" alt=""></p><h4 id="⼆、⽣成WIF或WIF-compressed格式私钥的步骤"><a href="#⼆、⽣成WIF或WIF-compressed格式私钥的步骤" class="headerlink" title="⼆、⽣成WIF或WIF-compressed格式私钥的步骤"></a>⼆、⽣成WIF或WIF-compressed格式私钥的步骤</h4><p>1、第⼀步，随机选取⼀个32字节的数作为私钥。私钥为64位16进制数字。</p><p>例如：</p><p>18E14A7B6A307F426A94F8114701E7C8E774E7F9A47E2C2035DB29A206321725</p><p>2、第⼆步，取上⼀步结果，前⾯加⼊版本号（版本号“0x80”），末尾添加压缩标识符（“0x01”）</p><p>根据是否添加压缩标识符，将私钥根式分为WIF和WIF-compressed格式，最终经过Base58编码后分别为51位长度和52位长度。</p><p>WIF格式以“5”开头，WIF-compressed格式以“L”或“K”开头。</p><p>8018E14A7B6A307F426A94F8114701E7C8E774E7F9A47E2C2035DB29A20632172501</p><p>3、第三步，取上⼀步结果，计算两次SHA-256后的哈希值</p><p>281938ff642c734eb0ffcc8a394c5490dcc5d67b79257832eb8011857018eeef</p><p>4、第四步，取上⼀步结果的前4个字节（8位⼗六进制）作为校验码</p><p>281938ff</p><p>5、第五步，把校验码加在第⼆步的结果后⾯，形成增加校验码之后的16进制格式</p><p>8018E14A7B6A307F426A94F8114701E7C8E774E7F9A47E2C2035DB29A206 32172501281938ff</p><p>6、第六步，⽤base58表示法变换⼀下私钥（这就是最常⻅见的私钥的形态）。</p><p>Kx45GeUBSMPReYQwgXiKhG9FzNXrnCeutJp4yjTd5kKxCitadm3C</p><p><code>⽣成私钥的步骤详⻅见⽹站</code> ——</p><p>[<a href="http://gobittest.appspot.com/PrivateKey]" rel="external nofollow noopener noreferrer" target="_blank">http://gobittest.appspot.com/PrivateKey]</a>:</p><p><img src="https://ws4.sinaimg.cn/large/e64a4785gy1fxq2h3karnj20r60oanb1.jpg" alt=""></p><h4 id="三、⽐特币地址⽣成"><a href="#三、⽐特币地址⽣成" class="headerlink" title="三、⽐特币地址⽣成"></a>三、⽐特币地址⽣成</h4><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">GenerateAddress</span><span class="token punctuation">(</span>pubkey <span class="token builtin">string</span><span class="token punctuation">,</span> nettype <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
<span class="token comment" spellcheck="true">//1、判断公钥有效性</span>
<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">130</span> <span class="token operator">&amp;&amp;</span> <span class="token function">len</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">66</span> <span class="token punctuation">{</span>
   err <span class="token operator">:=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"公钥输⼊入错误!"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> err 
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//2、计算公钥sha256</span>
hashString <span class="token operator">:=</span> cryptotool<span class="token punctuation">.</span><span class="token function">HASH</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">,</span> <span class="token string">"sha256"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//fmt.Println("sha256:", hashString)</span>

<span class="token comment" spellcheck="true">// 3、RipeMD160</span>
ripemd160String <span class="token operator">:=</span> cryptotool<span class="token punctuation">.</span><span class="token function">HASH</span><span class="token punctuation">(</span>hashString<span class="token punctuation">,</span> <span class="token string">"ripemd160"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//ripemd160String = fmt.Sprintf("%s", ripemd160String) </span>
<span class="token comment" spellcheck="true">//fmt.Println("ripemd160:", ripemd160String)</span>

<span class="token comment" spellcheck="true">// 4、增加⽹网络id号 ● ⽐比特币主⽹网id号:0x00 ● testnet测试⽹网络id号:0x6f </span>
prefix <span class="token operator">:=</span> <span class="token string">""</span>
<span class="token keyword">switch</span> nettype <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
        prefix <span class="token operator">=</span> <span class="token string">"00"</span> 
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
        prefix <span class="token operator">=</span> <span class="token string">"6f"</span> 
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
        prefix <span class="token operator">=</span> <span class="token string">"34"</span> 
<span class="token punctuation">}</span>
versionString <span class="token operator">:=</span> prefix <span class="token operator">+</span> ripemd160String
<span class="token comment" spellcheck="true">//fmt.Println("加前缀:", versionString)</span>

<span class="token comment" spellcheck="true">// 5、计算两次hash</span>
sha256DoubleString <span class="token operator">:=</span> cryptotool<span class="token punctuation">.</span><span class="token function">SHA256Double</span><span class="token punctuation">(</span>versionString<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//fmt.Println(sha256DoubleString)</span>

<span class="token comment" spellcheck="true">// 6、获取校验码</span>
rs <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">rune</span><span class="token punctuation">(</span>sha256DoubleString<span class="token punctuation">)</span> 
checknum <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//fmt.Println(checknum)</span>

<span class="token comment" spellcheck="true">// 7、形成16进制⽐比特币地址</span>
addrHex <span class="token operator">:=</span> versionString <span class="token operator">+</span> checknum 
<span class="token comment" spellcheck="true">//fmt.Println(addrHex)</span>

<span class="token comment" spellcheck="true">// 8、对16进制地址进⾏行行Base58编码</span>
arr<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> hex<span class="token punctuation">.</span><span class="token function">DecodeString</span><span class="token punctuation">(</span>addrHex<span class="token punctuation">)</span> 
addrBase58 <span class="token operator">:=</span> cryptotool<span class="token punctuation">.</span><span class="token function">Base58Encode</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> 
result <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s \n"</span><span class="token punctuation">,</span> addrBase58<span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//fmt.Println(result)</span>
<span class="token keyword">return</span> result<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

</code></pre><h4 id="四、默克尔根⽣生成"><a href="#四、默克尔根⽣生成" class="headerlink" title="四、默克尔根⽣生成"></a>四、默克尔根⽣生成</h4><blockquote><p> 以0为例：只有唯⼀⼀笔coinbase交易。那么coinbase交易的hash就是默克尔根的hash值</p><p> txhash_0 :=</p><p> “4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b”</p><p> res := “4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b”</p></blockquote><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">GetMerkleRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
<span class="token comment" spellcheck="true">//以98901为例例:有两笔交易易。coinbase交易易及真实交易易 </span>
txhash_01 <span class="token operator">:=</span>
<span class="token string">"16f0eb42cb4d9c2374b2cb1de4008162c06fdd8f1c18357f0c849eb423672f5f"</span>
txhash_02 <span class="token operator">:=</span>
<span class="token string">"cce2f95fc282b3f2bc956f61d6924f73d658a1fdbc71027dd40b06c15822e061"</span>
<span class="token comment" spellcheck="true">//cryptotool.HASH()</span>
<span class="token comment" spellcheck="true">//将两笔交易易进⾏行行⼩小端排序</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"交易易1:"</span> <span class="token punctuation">,</span> cryptotool<span class="token punctuation">.</span><span class="token function">ReverseHexString</span><span class="token punctuation">(</span>txhash_01<span class="token punctuation">)</span><span class="token punctuation">)</span> 
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"交易易2:"</span> <span class="token punctuation">,</span> cryptotool<span class="token punctuation">.</span><span class="token function">ReverseHexString</span><span class="token punctuation">(</span>txhash_02<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//5f2f6723b49e840c7f35181c8fdd6fc0628100e41dcbb274239c4dcb42ebf016     </span>
<span class="token comment" spellcheck="true">//61e02258c1060bd47d0271bcfda158d6734f92d6616f95bcf2b382c25ff9e2cc</span>
<span class="token comment" spellcheck="true">//将交易易拼接在⼀一起</span>
a <span class="token operator">:=</span>
<span class="token string">"5f2f6723b49e840c7f35181c8fdd6fc0628100e41dcbb274239c4dcb42ebf0166"</span>
<span class="token operator">+</span><span class="token string">"1e02258c1060bd47d0271bcfda158d6734f92d6616f95bcf2b382c25ff9e2cc"</span>
str <span class="token operator">:=</span> cryptotool<span class="token punctuation">.</span><span class="token function">SHA256Double</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true">//转成⼤大端排序格式</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"默克尔根:"</span> <span class="token punctuation">,</span> cryptotool<span class="token punctuation">.</span><span class="token function">ReverseHexString</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{color:#fff}.reward-tabs .wechat-tab .active{color:#fff;background-color:#22ab38}.reward-tabs .alipay-tab .active{color:#fff;background-color:#019fe8}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"> <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close"><i class="fa fa-close"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li></ul><div id="wechat"> <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"> <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div></div></div></div></div></div><script>$(function(){$("#reward .reward-link").on("click",function(){$("#rewardModal").openModal()}),$("#rewardModal .close").on("click",function(){$("#rewardModal").closeModal()})})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint"><p> <span class="reprint-tip">未经本人允许不得转载 - 感谢您的阅读</span><i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/posts/52fae707.html" class="b-link-green">比特币地址的生成算法</a></p></div></div></div><style>.v .vinput{padding:0}.vheader{background:#fbfbfb;border:none;border-radius:0;padding:0 10px 0 10px;margin:0;line-height:3;border-bottom:1px dashed #f5f5f5}.v .vwrap{padding:0;border:2px solid #fafafa}.v .vwrap .vedit{padding:10px 10px 0 10px}.v .vwrap .vcontrol{padding:10px 8px 0 12px}.v .vinfo .vcount .vnum{color:red}.v .vbtn{color:#fff;border-radius:3rem;background:#3cb371;padding:.5rem 2.45rem}.v .vlist .vcard .vhead .vsys{display:none}.v .vlist .vcard .vh .vmeta .vat{background-color:#7f7f7f!important;color:#fff!important;border-radius:3px!important;padding-left:10px!important;padding-right:10px!important}.v .vwrap .vedit .vctrl span{background-color:#ff8c69!important;color:#fff!important;border-radius:3px!important;padding:1px 5px 1px 5px!important}.v .vwrap .vheader .vinput{box-shadow:none;color:#0e0a0a;background:#fafafa;border:none;width:50%;height:100%}::-webkit-input-placeholder{color:#000;transition:opacity 250ms ease-in-out}:focus::-webkit-input-placeholder{opacity:.5}:-ms-input-placeholder{color:#000;transition:opacity 250ms ease-in-out}:focus:-ms-input-placeholder{opacity:.5}::-moz-placeholder{color:#000;opacity:1;transition:opacity 250ms ease-in-out}:focus::-moz-placeholder{opacity:.5}:-moz-placeholder{color:#000;opacity:1;transition:opacity 250ms ease-in-out}:focus:-moz-placeholder{opacity:.5}.v .info{display:none}.v .vwrap .vheader .vlink{display:none}.v .vwrap .vheader input:focus{border-color:#c4c8cb;box-shadow:none;border:none;outline:0}</style><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="valine-card card" data-aos="fade-up"><div class="comment" style="padding:12px"></div><script>new Valine({el:".comment",notify:!1,verify:!1,app_id:"B8rpy4srnRGi45Bf5LnjHijX-9Nh9j0Va",app_key:"cMaKM9IAt2UR3hQDD6ot7Bag",avatar:"",avatar_cdn:"https://gravatar.loli.net/avatar/9e63c80900d106cbbec5a9f4ea433a3e?size=80",placeholder:"说点什么吧~",pageSize:10})</script></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color">本篇</div><div class="card"><a href="/posts/52fae707.html"><div class="card-image"> <img src="https://ws1.sinaimg.cn/large/e64a4785gy1fxq19nnjc5j20ku0dw3yt.jpg" class="responsive-img" alt="比特币地址的生成算法"> <span class="card-title">比特币地址的生成算法</span></div></a><div class="card-content article-content"><div class="summary"> Go加密算法_⽐比特币地址的生成算法 ⼀、⽐特币地址的⽣成步骤(⼀)、概述1、⽐特币是建⽴在数学加密学基础上的，中本聪⽤了椭圆曲线数字签名算法（ECDSA）来产⽣⽐特币的私钥和公钥。 ECDSA算法（Elliptic Curve D</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i> 2018-11-30</span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/区块链/" class="post-category" target="_blank">区块链</a> <a href="/categories/区块链/密码学/" class="post-category" target="_blank">密码学</a></span></div></div><div class="card-action article-tags"> <a href="/tags/加密算法/" target="_blank"><span class="chip bg-color">加密算法</span></a> <a href="/tags/比特币/" target="_blank"><span class="chip bg-color">比特币</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇</div><div class="card"><a href="/posts/3e321210.html"><div class="card-image"> <img src="https://ws1.sinaimg.cn/large/e64a4785gy1fxovmx4lnwj20ku0dwgmo.jpg" class="responsive-img" alt="初识Go"> <span class="card-title">初识Go</span></div></a><div class="card-content article-content"><div class="summary"> HelloWorld程序解释及Go编码规范 ⼀、HelloWorld程序解释（⼀）、第⼀个HelloWorld程序package main import "fmt" func main(){ /*这是第一个简单的程序*/</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i> 2018-08-05</span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/后端/" class="post-category" target="_blank">后端</a></span></div></div><div class="card-action article-tags"> <a href="/tags/GoLang/" target="_blank"><span class="chip bg-color">GoLang</span></a></div></div></div></div></article></div></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"><span id="busuanzi_container_site_pv" style="display:none"><span class="fa fa-eye"></span> &nbsp;<span id="busuanzi_value_site_pv"></span></span> &nbsp;&nbsp;<span id="busuanzi_container_site_uv" style="display:none"><span class="fa fa-user"></span> &nbsp;<span id="busuanzi_value_site_uv"></span></span></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/BaiMingxu" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50" rel="external nofollow noopener noreferrer"><i class="fa fa-github"></i></a><a href="mailto:mxdlsm@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50" rel="external nofollow noopener noreferrer"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ联系我: 806605375" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"> <span class="title">搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" autofocus></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">searchFunc("/search.xml","searchInput","searchResult")</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><link href="https://cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/libs/materialize/js/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script async>window.onload=function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="/sw-register.js?v="+Date.now(),t.parentNode.insertBefore(e,t)}</script></body></html>